q->lock held and irqs dis